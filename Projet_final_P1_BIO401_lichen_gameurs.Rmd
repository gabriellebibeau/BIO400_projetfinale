---
title: "L'effet de la prédation intraguilde sur les équilibres de populations dans une communauté"
output: html_document
author: "Les lichens gameurs"
---

## Question biologique
Quelles sont les conséquences d'incorporer la prédation intraguilde (PIG) dans différents modèles de compétition et de prédation?

***
## Hypothèse
R.D. Holt et G.A. Polis avancent qu'il y a un grand potentiel d'États alternatifs stables avec l'ajout de PIG dans des modèles préexistants tels que le modèle Consommateur-ressource, le modèle proie-prédateur de Lotka-Voltera et le modèle de compétition d'exploitation de Schoener.

***
## Informations pertinentes
La PIG est définit par un système ou un prédateur IG se nourrit de la proie IG ainsi que que de la même ressource que la proie IG, créant des intéractions de compétitions entre le prédateur IG et la proie IG. 

Le modèle basé sur Lotka-Voltera peut être visualisé par le schéma suivant :
![Schéma du modèle basé sur Lotka-Voltera.](Schema_LV5.png)

Le modèle basé sur Schoener peut être visualisé par le schéma suivant :
![Schéma du modèle basé sur Schoener.](Schema_S8.png)
Ces deux schémas comportent les mêmes relations qu'il faudra établir dans nos modèles : La conversion de ressources en nouveaux individus, autant pour le prédateur que pour la proie; le renouvellement de la ressource; la conversion de proie en nouveau prédateur; la mortalité des proies et des prédateurs.

***
## Méthodes
Les figures dans l'article n'ont été produites qu'avec les modèles basés sur Lotka-Voltera et Schoener auquels des termes associés au PIG ont été ajoutés. Nous avons donc décidé de seulement modéliser ceux-ci.

Le modèle Lotka-Voltera avec PIG est définit par le système suivant :
$$
\frac{dP}{dt} = P(b'a'R + \beta\alpha N - m');
$$ 
$$
\frac{dN}{dt} = N(abR - \alpha P - m);
$$ 
$$
\frac{dR}{dt} = R(r(1 - \frac{R}{K}) - aN - a'P).
$$ 
Les variables dans ces équations sont définies comme suit :
$P$ : la densité du prédateur IG;
$N$ : la densité de la la proie IG;
$R$ : la densité de la ressource commune;
$a$ : la réponse fonctionnelle de la proie IG vers la ressource commune;
$a'$ : la réponse fonctionnelle du prédateur IG vers la ressource commune;
$\alpha$ : le taux de mortalité de la proie IG causée par le prédateur IG;
$b$ : le taux de conversion de la consommation de la ressource vers la reproduction de la proie IG;
$b'$ : le taux de conversion de la consommation de la ressource vers la reproduction du prédateur IG;
$\beta$ : le taux de conversion de la consommation de la proie IG vers la reproduction du prédateur IG;
$K$ : la quantité de ressource commune lorsqu'elle est stable;
$m$ : le taux de mortalité densité-dépendant de la proie IG;
$m'$ : le taux de mortalité densité-dépendant du prédateur IG;
$r$ : le taux de croissance de la ressource commune.

L'équation de $\frac{dP}{dt}$ a trois termes multipliés par $P$. Le premier représente les gains en population (reproduction) des prédateurs IG en fonction de la densité de la ressource commune. Le deuxième illustre les gains en population du prédateurs IG grâce à la consommation de la proie IG en fonction de la densité de la proie IG. Le dernier terme est simplement le taux de mortalité du prédateurs IG.

L'équation de $\frac{dN}{dt}$ signifie la même chose, mais pour la proie IG, sauf en ce qui a trait au deuxième terme. En effet, celui-ci représente le mortalité due au prédateurs IG en fonction de la densité de prédateurs IG.

L'équation de $\frac{dR}{dt}$ a trois termes multipliés par $R$. Le premier est la croissance logistique de la ressource commune dans le système. Les deuxième et troisième termes représentent la consommation de la ressource commune par respectivement la proie IG et le prédateurs IG en fonction de leur densité.


Le modèle de Schoener avec PIG est définit par le système suivant :
$$
\frac{dP}{dt} = P(\frac{b'e'I}{e'P + eN} + \beta\alpha N - m');
$$ 
$$
\frac{dN}{dt} = N(\frac{beI}{e'P + eN} - \alpha P - m).
$$ 

Les nouvelles variables dans ces équations sont définies comme suit (les définitions précédentes sont toujours valables) :
$e$ : l'habileté relative de la proie IG à compétitionner pour la ressource commune;
$e'$ : l'habileté relative du prÃ©dateur IG à compétitionner pour la ressource commune;
$I$ : le taux d'entrée de la ressource commune dans le système.

L'équation de $\frac{dP}{dt}$ a trois termes multipliés par $P$. Le premier représente la quantité de ressource commune que le prédateur IG est capable d'aller chercher sur la quantité totale et constante de ressource commune entrante en compétitionnant avec la proie IG. Le deuxième illustre les gains en population du prédateurs IG grâce à la consommation de la proie IG en fonction de la densité de la proie IG. Le dernier terme est simplement le taux de mortalité du prédateurs IG.

L'équation de $\frac{dN}{dt}$ signifie la même chose, mais pour la proie IG, sauf en ce qui a trait au deuxième terme. En effet, celui-ci représente le mortalité due au prédateurs IG en fonction de la densité de prédateurs IG.

***
## Suppositions
1. Le prédateur IG est dépendant de deux sources d'alimentation : la proie IG et la ressource commune. La proie IG est seulement dépendante de la ressource commune.

1. Dans le modèle basé sur Lotka-Voltera, la ressource commune croit en suivant une courbe logistique. Dans le modèle basé sur Schoener, la ressource commune croit à taux constant.

1. La portion du taux de croissance du prédateur IG permis par la consommation de la proie IG est plus grande que 0. 

1. Le prédateur IG bénéficie des effets positifs de la consommation de la proie IG de façon instannée. 

1. La proie IG est meilleure que le prédateur IG dans l'exploitation de la ressource commune.

1. Dans le modèle basé sur Lotka-Voltera, les réponses fonctionnelles sont des intéractions linéaires et les taux de croissance des populations sont proportionnels aux taux de consommation. Ces variables ne sont pas linéaires dans le modèle basé sur Schoener.

***
## Calcul
Les calculs avec le modèle basé sur Lotka-Voltera ont été fait comme suit :
```{r, eval=FALSE}
library(deSolve)
library(phaseR)

#Fonction
LV5 <- function(t, ConI, parms5 = c(a,a_prime,alpha,b,b_prime,beta,K,m,m_prime,r)){
  
  with(as.list(ConI, parms5), {
    # Lotka-voltera
    dP <- P*(b_prime*a_prime*R + beta*alpha*N - m_prime) # dP/dt
    dN <- N*(a*b*R - m - alpha*P) #dN/dt
    dR <- R*(r*(1- (R/K)) - a*N - a_prime*P) #dR/dt
    
    # Résultat
    res <- c(dP = dP, dN = dN, dR = dR)
    return(list(res))
  })
}


#Conditions initiales
P0 <- 0.3333 #prédateur IG
N0 <- 0.3333 #proie IG
R0 <- 1 - P0 - N0 #Ressource
CI_LV5 <- c(P=P0, N=N0, R=R0)


#Boucle d'équilibre
figure_1 <- matrix(0.5, 11, 11) #création de la matrice pour faire une image
lim <- 0.01 #Comme R ne reconnait pas 0, nous avons choisi la valeur 0.01
steps <- 100 #temps auquel l'équilibre aura surement été atteint

for(i in 0:10){
  for(j in 0:10){
    
    parametre_LV5 <- c(a <- 1, #paramètres (a' et b' variables entre 0 et 1)
               a_prime <- i/10,
               alpha     <- 0.5,
               b         <- 1,
               b_prime <- j/10,
               beta      <- 1,
               K         <- 1,
               m         <- 0.5,
               m_prime   <- 0.5,
               r         <- 1)

    #Solution du système d'équation
    LV5_sol <- ode(y=CI_LV5, times= seq(1,steps), func= LV5, parms= parametre_LV5)
    
    #Classement des équilibres
    if(LV5_sol[steps,'P'] < lim & LV5_sol[steps,'N'] > lim){ #Prédateur IG exclus
      figure_1[i+1,j+1] <- 0.5 #pour être entre 0 et 1 et faire partie de la 1re catégorie de la fonction image
      
    }else if(LV5_sol[steps,'P'] > lim & LV5_sol[steps,'N'] < lim){ #Proie IG exclus
      figure_1[i+1,j+1] <- 1.5
      
    }else if(LV5_sol[steps,'P']  > lim & LV5_sol[steps,'N']  > lim){ #Coexistance stable
      figure_1[i+1,j+1] <- 2.5
      
    }else{  #Instable
      figure_1[i+1,j+1] <- 3.5
      
    }

  } #Fin boucle j
} #Fin boucle i


#Visualisation
image (figure_1, col = c("cyan2", "salmon", "green", "brown4"), breaks = 0:4, xlab = 'b_prime' , ylab = 'a_prime')
legend(x = 'bottomleft', legend = c('Instable', 'Proie IG exclu','Coexistance stable', 'Prédateur IG exclu'), fill = 1:4)

```


Les calculs avec le modèle basé sur Schoener sont les suivants :
```{r, eval=FALSE}
library(deSolve)
library(ggplot2)
library(phaseR)


```

## Résultats
Pour le premier modèle (basé sur Lotka-Voltera),la figure d'équilibres obtenue est la suivante : 

![Figure 1. Différents états d'équilibres possibles lorsqu'il y a de la prédation intraguilde dans le modèle proie-prédateur de Lotka-Voltera](Fig1.png)

Dans cette figure, les paramètres $a'$ et $b'$ ont été variés entre 0 et 1, alors que les suivants ont été gardés constants : 

$a = 1$

$\alpha = 0.5$

$b = 1$

$\beta = 1$

$K = 1$

$m = 0.5$

$m' = 0.5$

$r = 1$


Pour le deuxième modèle (basé sur Schoener), la figure d'équilibres suivante a été obtenue : 

![Schéma du modèle basé sur Schoener.](Schema_S8.png)

Ce sont les paramètres suivants qui ont été utilisé pour obtenir cette figure


## Interprétations biologiques
L'hypothèse de départ était qu'il y avait une création de plusieurs états alternatifs stables lorsqu'on ajoutait de la prédation IG dans des modèles préexistants. Le modèle proie-prédateur de Lotka-Voltera ainsi que le modèle de compétition d'exploitation de Schoener ont été testés. D'abord, le modèle proie-prédateur avec IG permet d'observer qu'il existe 3 états d'équilibres stables : une absence totale de proie IG, une absence totale de prédateur IG et une coexistance. Lorsque la réponse fonctionnelle du prédateur IG vers la ressource commune et le taux de conversion de la ressource sont bas (Somme en bas de 1.4), le prédateur IG est toujours exclu. On pourrait en comprendre que le prédateur IG n'arrive pas assez à subvenir à ces besoins avec si peu de gains dans ces conditions. Lorsque les deux taux étaient très élevés (Somme au dessus de 1.8), c'est plutôt la proie IG qui était toujours exclue. On peut en déduire que le prédateur IG est trop compétitifs pour la ressource commune en ces conditions pour permettre à la proie IG de survivre. Finalement, une coexistance stable semble se produire lorsque la somme des deux mêmes taux se trouvent entre 1.5 et 1.7. On peut alors interpréter qu'il y a un équilibre fragile dans la compétition pour la ressource commune entre la proie IG et le prédateur IG et que c'est seulement en ces conditions qu'ils coexistent sans modifier leur taille de population. 

Ensuite, le modèle de compétition d'exploitation avec IG illustrait ...


